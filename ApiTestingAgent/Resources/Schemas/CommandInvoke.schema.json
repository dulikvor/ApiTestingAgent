{
  "type": "object",
  "properties": {
    "analysis": {
      "type": "string",
      "description": "Full user-facing message, including all required sections formatted as markdown."
    },
    "outcomeMatched": {
      "type": "boolean",
      "description": "True if the actual result matches the expected outcome. For execution plans, true only if ALL steps succeeded."
    },
    "correctedUserMessage": {
      "type": "string",
      "description": "If expectations were not met and a content-only change would likely fix it, provide a revised natural-language user instruction to guide command selection."
    },
    "stepNumber": {
      "type": "integer",
      "description": "For execution plans, the step number that the correctedUserMessage applies to. Omit for single commands."
    },
    "executionSummary": {
      "type": "object",
      "description": "Summary of execution plan results, if applicable.",
      "properties": {
        "totalSteps": {
          "type": "integer",
          "description": "Total number of steps in the execution plan."
        },
        "successfulSteps": {
          "type": "integer",
          "description": "Number of steps that completed successfully."
        },
        "failedStep": {
          "type": "integer",
          "description": "The step number where execution failed, if any."
        },
        "stoppedExecution": {
          "type": "boolean",
          "description": "Whether execution was stopped due to a failure."
        }
      }
    },
    "nextState": {
      "type": "string",
      "enum": ["CommandSelect", "ExpectedOutcome", "PlanInvoke", "ExecutionPlanSelect", "None"],
      "description": "The next state to transition to."
    },
    "reasoning": {
      "type": "string",
      "description": "A brief explanation of the logic and evidence leading to current decision."
    }
  },
  "required": [
    "analysis",
    "nextState",
    "outcomeMatched",
    "correctedUserMessage",
    "reasoning"
  ],
  "x-userType": "ApiTestingAgent.Resources.Schemas.CommandInvokeOutput, ApiTestingAgent"
}